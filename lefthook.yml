pre-commit:
  parallel: true
  commands:
    format:
      glob: "*.go"
      skip:
        - merge
        - rebase
      run: goimports -w {staged_files} && git add {staged_files}

    lint:
      glob: "*.go"
      skip:
        - merge
        - rebase
      run: golangci-lint run --fast {staged_files} 2>/dev/null || true

    security:
      glob: "*.go"
      skip:
        - merge
        - rebase
      run: go vet ./...

pre-push:
  commands:
    test:
      run: go test -v ./...

    lint:
      run: golangci-lint run ./...

    security-scan:
      skip: true  # Temporarily skip due to Windows bash compatibility issues
      run: |
        if command -v snyk > /dev/null 2>&1; then
          echo "Running Snyk security scan..."
          snyk test --severity-threshold=medium || echo "⚠ Security issues found, but continuing..."
        else
          echo "⚠ Snyk not installed. Install with: npm install -g snyk"
        fi
      fail: false

